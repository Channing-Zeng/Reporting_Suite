genome: hg19

# steps:
# - VarAnnotate
# - VarQC
# - VarFilter
# - VarQC_after
# - TargetCov
# - NGScat
# #- QualiMap
# - VarQC_Summary
# - TargetCov_Summary

vardict_steps:
- VarDict
- TestSomatic
- Var2Vcf_Somatic
- VarAnnotate
- VarQC
- VarFilter
- VarQC_after
- VarQC_Summary


filter_reject: False   ## Before annotation and QC, drop variants
                       ## that set REJECT in the FILTER field

variant_filtering:
  impact:             'MODERATE|HIGH'

#  filt_depth:         0      # DP.     The filtering total depth. The raw variant will be filtered on first place if the total depth is less then [filt_depth].
  filt_p_mean:        0       # QUAL.   The filtering mean position in reads for variants. The raw variant will be filtered on first place if the mean posititon is less then [filt_p_mean].
#  filt_q_mean:        0    # PMEAN.  The filtering mean base quality phred score for variants. The raw variant will be filtered on first place if the mean quality is less then [filt_q_mean].

  min_freq:           0.05    # AF.     When individual allele frequency < feq for variants, it was considered likely false poitives.
  mean_mq:            20      # MQ.     The filtering mean mapping quality score for variants. The raw variant will be filtered if the mean mapping quality score is less then specified.
  mean_vd:            2       # VD.     The filtering variant depth. Variants with depth < [mean_vd] will be considered false positive.
  signal_noise:       4       # SN.     Signal/noise value.
  min_p_mean:         5       # QUAL.   The minimum mean position in reads for variants.
  min_q_mean:         25      # PMEAN.  The minimum mean base quality phred score for variant.

  fraction:           1       # When a novel variant is present in more than [fraction] of samples and mean allele frequency is less than [freq], it's considered as likely false positive.
  freq:               0.15    # When the average allele frequency is also below the [freq], the variant is considered likely false positive.
  sample_cnt:         10      # When the variant is detected in greater or equal [sample_cnt] samples, the variant is considered likely false positive.
  max_ratio:          1       # When a variant is present in more than [fraction] of samples, and AF < 0.3, it's considered as likely false positive, even if it's in COSMIC.
  count_undetermined: True    # Undeteremined won't be counted for the sample count.
  bias:               False   # Filter novel or dbSNP variants with strand bias "2;1" or "2;0" (BIAS field) and AF < 0.3.
  maf:                0.0025  # GMAF.   If there's MAF with frequency, it'll be considered dbSNP regardless of COSMIC.


quality_control:
  databases: ['dbsnp']
  novelty: ['all', 'known', 'novel']
  db_for_summary: dbsnp
  metrics: ['nEvalVariants', 'nSNPs', 'nInsertions', 'nDeletions',
           'nVariantsAtComp', 'compRate', 'nConcordant', 'concordantRate',
           'variantRate', 'variantRatePerBp', 'hetHomRatio', 'tiTvRatio']
  variant_distribution_scale: 1000  ## in kilobases

coverage_reports:
  depth_thresholds: [1, 5, 10, 25, 50, 100, 500, 1000, 5000, 10000, 50000]


## Annotation with various tools.
#gatk:
#  options: ['-dt NONE']
#  all-annotations: False
#  annotations:                # Field names in final VCF:
#  - Coverage                  # DP
#  - BaseQualityRankSumTest    # BaseQRankSum
#  - FisherStrand              # FS
#  - GCContent                 # GC
#  - HaplotypeScore            # HaplotypeScore
#  - HomopolymerRun            # HRun
#  - RMSMappingQuality         # MQ
#  - MappingQualityRankSumTest # MQRankSum
#  - MappingQualityZero        # MQ0
#  - QualByDepth               # QD
#  - ReadPosRankSumTest        # ReadPosRankSum
#  - DepthPerAlleleBySample
#  - AlleleBalanceBySample     # AB

#db_nsfp:
#  all-annotations: False
#  annotations:
#  - SIFT_score
#  - Polyphen2_HVAR_score
#  - Polyphen2_HVAR_pred
#  - LRT_score
#  - LRT_pred
#  - MutationTaster_score
#  - MutationTaster_pred
#  - MutationAssessor_score
#  - MutationAssessor_pred
#  - FATHMM_score
#  - Ensembl_geneid
#  - Ensembl_transcriptid
#  - Uniprot_acc
#  - 1000Gp1_AC
#  - 1000Gp1_AF
#  - ESP6500_AA_AF
#  - ESP6500_EA_AF

#db_snp:
#  all-annotations: False
#  annotations:
#  - ID
#  - SAO
#  - VC
#  - PM
#  - HD
#  - KGPROD
#  - PH3
#  - OM
#  - CAF
#  - COMMON
#  - dbSNPBuildID
#  - G5
#  - CDA

#cosmic:
#  all-annotations: False
#  annotations:
#  - ID
#  - CNT
#  - AA
#  - CDS

#custom_vcfs: {}

snpeff:
  clinical_reporting: True    ## Canonical transcripts + output in HGVS notation
  cancer: False
  # only_transcripts: '/ngs/PHB/analysis/tBRCA_Qiagen_GRPanel_StMarys_2013/ensemble-variant/variants/transcripts.txt'
  extra_opts: ''

#tracks:
#- /Users/vladsaveliev/vagrant/bcbio-nextgen/tests/test_automated_output/analysis_blocks.bed

tsv_fields:
- SAMPLE                        : Sample
- CHROM                         : Chromosome
- POS                           : Position
- REF                           : REF
- ALT                           : ALT
- ID                            : ID
- QUAL                          : QualityScore
- DP                            : Depth
- FILTER                        : Filter
- dbSNPBuildID                  : dbSNPBuildID

- "EFF[*].EFFECT"               : Effect
- "EFF[*].IMPACT"               : Impact
- "EFF[*].FUNCLASS"             : FunctionalClass
- "EFF[*].CODING"               : CodingRegion
- "EFF[*].GENE"                 : Gene
- "EFF[*].CODON"                : Codon
- "EFF[*].AA"                   : AminoAcid
- "EFF[*].AA_LEN"               : AminoAcidLength
- CNT                           : CountInCosmic
- AA                            : AminoAcidInCosmic
- CDS                           : CDSInCosmic
- "EFF[*].RANK"                 : Rank
- BaseQRankSum                  : BaseQailityRankSum
- FS                            : FischerScore
- GC                            : GC
- HaplotypeScore                : HaplotypeScore
- HRun                          : HomopolymerRunSize
- MQ                            : MappingQuality
- MQRankSum                     : MQualityRankSum
- MQ0                           : TotalMappingQualityZeroReads
- QD                            : QualityByDepth
- ReadPosRankSum                : ReadPosRankSum

## FORMAT fields for the sample
#- GEN[*].GT: Genotype #gt_GT                         : Genotype
#- gt_FT                        : GenotypeWasCalled
#- gt_GL                        : GenotypeLikelihoods
#- gt_GLE                       : GenotypeLikelihoodsOfHeterogeneousPloidy
#- gt_GP                        : GenotypePosteriorProbs_PhredScaled
#- gt_GQ                        : ConditionalGenotypeQuality
#- gt_HQ                        : HaplotypeQualities
#- gt_PS                        : PhaseSet
#- gt_PQ                        : PhasingQuality       # phred-scaled probability
#                                                      # that alleles are ordered
#                                                      # incorrectly in a heterozygote
#- GEN[*].AD                  : AllelicDepths_Alt
##- GEN[*].AD[1]                  : AllelicDepths_Ref
#- GEN[*].EC                     : ExpAlleleCounts
#- GEN[*].PL[0]                   : GenotypeLikelihoods_AA
#- GEN[*].PL[1]                   : GenotypeLikelihoods_AB
#- GEN[*].PL[2]                   : GenotypeLikelihoods_BB


## FORMAT fields for the sample
- GEN[*].GT                     : Genotype
#- GEN[*].FT                     : GenotypeWasCalled
#- GEN[*].GL                     : GenotypeLikelihoods
#- GEN[*].GLE                    : GenotypeLikelihoodsOfHeterogeneousPloidy
- GEN[*].PL                  : GenotypeLikelihoods
#- GEN[*].PL[1]                  : GenotypeLikelihoods_AB
#- GEN[*].PL[2]                  : GenotypeLikelihoods_BB
#- GEN[*].GP                     : GenotypePosteriorProbs_PhredScaled
- GEN[*].GQ                     : ConditionalGenotypeQuality
#- GEN[*].HQ                     : HaplotypeQualities
#- GEN[*].PS                     : PhaseSet
#- GEN[*].PQ                     : PhasingQuality      ## phred-scaled probability that alleles are ordered incorrectly in a heterozygote
#- GEN[*].EC                     : ExpAlleleCounts
- GEN[*].AD                     : AllelicDepths
- GEN[*].AO                     : AlleleObservationCount
- GEN[*].QA                     : QualitySumForAltObservations
- GEN[*].QR                     : QualitySumForRefObservations
- GEN[*].RO                     : RefAlleleObservationCount

# dbsnp
- SAO                           : VariantAlleleOrigin
- AB                            : AlleleBalanceAtHeterozygousSites  # from GATK
- VC                            : VariationClass
- TYPE                          : AlleleType
- PM                            : VariantIsPrecious
#- MUT                           : CitedMutation
- HD                            : PresentInDBGap
- KGPROD                        : Has1000GenomeSubmission
- PH3                           : HapMapValidated
- OM                            : InOMIM
- COMMON                        : CommonVariant
#- CLNSIG                        : ClinicalSignificance
- G5                            : 5%MAFinPopulationsCAF
#- MAF                           : GlobalMinorAlleleFrequency
#- CDA                           : InClinicalDiagnosticAssay
- set                           : SourceVCF_forMergedRecInCombineVariants
- analysis_blocks               : analysis_blocks


verbose: True
keep_intermediate: True
reuse_intermediate: False

make_maf: True
no_correct_vcf: True