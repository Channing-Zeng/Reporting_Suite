{"name":"AstraZeneca NGS Reporting Suite","tagline":"Target sequencing coverage analysis, Variant annotation and quality control, Post-BCBio-nextgen processing","body":"# NGS Reporting Suite\r\nVariant annotation, filtering and quality control, targeted sequencing coverage analysis.\r\n\r\n## Common options for all scripts\r\n\r\n* `--sys-cnf SYSTEM_INFO.yaml`. Configuration file with paths to external tools and genome resources. The default is system_info_Waltham.yaml\r\n\r\n* `--run-cnf RUN_INFO.yaml`. Customised run details: list of annotations/QC metrics/databases/filtering criteria. The default is run_info.yaml\r\n\r\n* `-o DIR` Output directory to save the results. Intermediate files will also be stored in DIR/work_SAMPLE. \r\n\r\n* `-s NAME` Sample name. Default is the base name of the input VCF/BAM before the first . or - (i.e. sample-mutect.vcf will give the name \"sample\").\r\n\r\n* `-t N` Number of threads.\r\n\r\n* `--reuse` Reuse intermediate results.\r\n\r\n* `--clean` Remove DIR/work_SAMPLE directory.\r\n\r\n* `--tmp-base DIR` Base directory to store tmp files. Default is /ngs/tmp.\r\n\r\nNote that all options have defaults in run_info.yaml and can be overwritten by inputting a different configuration file with the option --run-cnf.\r\n\r\n## Variant annotation\r\n\r\n`varannotate.py --vcf SAMPLE.vcf[.gz] [--bam SAMPLE.bam] -o OUT_DIR`\r\n\r\n`OUT_DIR` will contain:\r\n* `SAMPLE.anno.vcf`\r\n* `SAMPLE.anno.tsv`\r\n* `SAMPLE.anno.maf`\r\n\r\nThe script integrates annotations from GATK, DB NSFP, dbSNP, COSMIC, SNPEff, custom set of VCF and BED files. See default configuration file run_info.yaml. Custom file can be provided by the --run-cnf options.\r\n\r\nSAMPLE.anno.tsv file contains the following fields:\r\n* Sample                                                            \r\n* Chromosome                                                        \r\n* Position                                                          \r\n* REF                                                               \r\n* ALT                                                               \r\n* ID                                                                \r\n* QualityScore                                                      \r\n* Depth                                                             \r\n* Filter                                                            \r\n* dbSNPBuildID                                                  \r\n* Effect                                                            \r\n* Impact                                                            \r\n* FunctionalClass                                                   \r\n* CodingRegion                                                      \r\n* Gene                                                              \r\n* EnsemblGeneID                                                     \r\n* EnsemblTranscriptID                                               \r\n* UniportAccNumber                                                  \r\n* Codon                                                             \r\n* AminoAcid                                                         \r\n* AminoAcidLength                                                   \r\n* CountInCosmic                                                     \r\n* AminoAcidInCosmic                                                 \r\n* CDSInCosmic                                                       \r\n* OncomineCancer                                                    \r\n* OncominePatient                                                   \r\n* OncomineMutClass                                                  \r\n* OncomineMutClassPC                                                \r\n* Rank                                                              \r\n* BaseQailityRankSum                                                \r\n* FischerScore                                                      \r\n* GC                                                                \r\n* HaplotypeScore                                                    \r\n* HomopolymerRunSize                                                \r\n* MappingQuality                                                    \r\n* MQualityRankSum                                                   \r\n* TotalMappingQualityZeroReads                                      \r\n* QualityByDepth                                                    \r\n* ReadPosRankSum                                                   \r\n* Genotype                                                          \r\n* GenotypeLikelihoods_PhredScaled                                   \r\n* AllelicDepthsForRefAndAlt                                        \r\n* VariantAlleleOrigin                                               \r\n* AlleleBalanceAtHeterozygousSites  # from GATK                     \r\n* VariationClass                                                    \r\n* AlleleType                                                        \r\n* VariantIsPrecious                                                   \r\n* PresentInDBGap                                                    \r\n* Has1000GenomeSubmission                                           \r\n* HapMapValidated                                                   \r\n* InOMIM                                                            \r\n* CommonVariant                                                     \r\n* 5%MAFinPopulationsCAF                                             \r\n* SiftScore                                                         \r\n* PolyPhen2Score                                                    \r\n* PolyPhen2Prediction                                               \r\n* LrtScore                                                          \r\n* LrtPrediction                                                     \r\n* MutationTasterScore                                               \r\n* MutationTasterPrediction                                          \r\n* MutationAssessorScore                                             \r\n* MutationAssessorPrediction                                        \r\n* FATHMMScore                                                       \r\n* 1000GenomesAlleleCount                                            \r\n* 1000GenomesAlleleFrequency                                        \r\n* ESP6500AfricanAmericanAlleleFrequency                             \r\n* ESP6500EuropeanAmericanAlleleFrequency                            \r\n* CPGIsland                                                         \r\n* GenomicDuplication                                                \r\n* KnownRepeat                                                       \r\n* KnownCopyNumber                                                   \r\n* SourceVCF_forMergedRecInCombineVariants                           \r\n\r\n## Variant QC\r\n\r\n`varqc.py --vcf VARIANTS.vcf[.gz] -o OUT_DIR`\r\n\r\n`OUT_DIR` will contain:\r\n* SAMPLE.varqc.txt\r\n* SAMPLE.variant_distribution.png\r\n* SAMPLE.indels.png\r\n* SAMPLE.substitutions.png\r\n\r\nSAMPLE.vcfqc.txt calculates the following values:\r\n\r\n* nEvalVariants\r\n* nSNPs\r\n* nInsertions\r\n* nDeletions\r\n* nVariantsAtComp\r\n* compRate\r\n* nConcordant\r\n* concordantRate\r\n* variantRate\r\n* variantRatePerBp\r\n* hetHomRatio\r\n* tiTvRatio\r\n\r\nThe values also calculated separately for novel and known variants.\r\nFor comparison, the values separately calculated for dbSNP, COSMIC, 1000genomes, and also average number is taken.\r\n\r\n### Summary\r\n\r\n`varqc_summary.py -d BCBIO_FINAL_DIR [-s samples.txt]`\r\n\r\nGenerates project-level reports for each sample:\r\n* varqc.summary.txt\r\n\r\n## Variant filtering\r\n\r\n`varfilter.py --vcf VARIANTS.vcf[.gz] > VARIANTS.vcf`\r\n\r\nThe program filters an annotated VCF file by SNPEff and using dbSNP and COSMIC. It adds REJECT into the FILTER column if variant \r\n\r\nThe program can be configurated in run_info.yaml, or by command line options. The defaults are:\r\n\r\n* `count_undetermined`: True    \r\nUndeteremined won't be counted for the sample count.\r\n* `bias`:               0.4     \r\nNovel or dbSNP variants with strand bias \"2;1\" or \"2;0\" and AF < 0.3 will be considered as false positive.\r\n\r\n* `fraction`:           1       \r\nWhen a novel variant is present in more than [fraction] of samples and mean allele frequency is less than [freq], it's considered as likely false positive.\r\n* `freq`:               10      \r\nWhen the average allele frequency is also below the [freq], the variant is considered likely false positive.\r\n* `sample_cnt`:         0.15    \r\nWhen the variant is detected in greater or equal [sample_cnt] samples, the variant is considered likely false positive.\r\n\r\n* `max_ratio`:          1       \r\nWhen a variant is present in more than [fraction] of samples, and AF < 0.3, it's considered as likely false positive, even if it's in COSMIC.\r\n* `min_freq`:           0.05    \r\nWhen individual allele frequency < feq for variants, it was considered likely false poitives.\r\n* `mean_mq`:            20      \r\nThe filtering mean mapping quality score for variants. The raw variant will be filtered if the mean mapping quality score is less then specified.\r\n* `mean_vd`:            2       \r\nThe filtering variant depth. Variants with depth < [mean_vd] will be considered false positive.\r\n`maf`:                0.0025  \r\nIf there's MAF with frequency, it'll be considered dbSNP regardless of COSMIC.\r\n* `signal_noise`:       4       \r\nSignal/noise value.\r\n* `filt_depth`:         0       \r\nThe filtering total depth. The raw variant will be filtered on first place if the total depth is less then [filt_depth].\r\n\r\n* `min_p_mean`:         5       \r\nThe minimum mean position in reads for variants.\r\n* `min_q_mean`:         25      \r\nThe minimum mean base quality phred score for variant.\r\n* `filt_p_mean`:        0       \r\nThe filtering mean position in reads for variants. The raw variant will be filtered on first place if the mean posititon is less then [filt_p_mean].\r\n* `filt_q_mean`:        0       \r\nThe filtering mean base quality phred score for variants. The raw variant will be filtered on first place if the mean quality is less then [filt_q_mean].\r\n\r\nA novel variant (non-dbSNP, non-COSMIC) is considered false positive if all three conditions ([fraction], [freq], [sample_cnt]) are met. Any variant meeting the [min_p_mean] or [min_q_mean] conditions are also considered likely false positive. False positive variants are annotated REJECT in the FILTER column, PASS otherwise.\r\n\r\n## Target sequencing coverage statistics\r\n\r\n`targetcov.py --bam SAMPLE.bam --bed PANEL.bed -o OUT_DIR`\r\n\r\n`OUT_DIR` will contain:\r\n* SAMPLE.targetseq.details.gene.txt\r\n* SAMPLE.targetseq.summary.txt\r\n\r\n### Summary\r\n\r\n`targetcov_summary.py -d BCBIO_FINAL_DIR [-s samples.txt]`\r\n\r\nGenerates project-level reports for each sample:\r\n* targetcov.summary.txt\r\n\r\n## NGScat\r\n\r\n`ngscat.py --bam SAMPLE.bam --extra-bam SAMPLE2.bam --bed PANEL.bed -o OUT_DIR --saturation y`\r\n\r\n## Post-BCBio results processing.\r\n\r\n`post_for_bcbio.py -d BCB_FINAL_DIR [-s samples.txt] -b PANEL.bed --vcf-suffix mutect [-q]`\r\n\r\nFor each sample in the list, runs the following steps:\r\n* VarAnnotate\r\n* VarQC\r\n* VarFilter\r\n* TargetCov\r\n* NGScat\r\n\r\n`-q` options adds QualiMap step.\r\n\r\nThe steps are customisable at run_info.yaml.\r\n\r\nUses qsub to submit jobs. The qsub command line template is the following:\r\n\r\n`{qsub} -pe smp {threads} -S /bin/bash -q batch.q -j n -o {out_fpath} -e {log_fpath} {hold_jid_line} -N {job_name} {runner_script} \"{cmdline}\"`\r\n\r\nFinally generates summaries for TargetCov and VarQC.\r\n\r\n***\r\n\r\nAll scripts take their configuration from `run_info.yaml` by default. Custom configuration file can be provided using the`--run-cnf` option.\r\n\r\n===============\r\n\r\n### Authors and Contributors\r\nJustin Johnson (@BioInfo), Miika Ahdesmaki (@mjafin), Alexey Gurevich (@alexeigurevich), Alla Bushoy (@abushoy), and Vlad Saveliev (@vladsaveliev).\r\n","google":"UA-51814523-1","note":"Don't delete this file! It's used internally to help with page regeneration."}